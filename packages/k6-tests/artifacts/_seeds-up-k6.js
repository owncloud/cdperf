"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _chunkPLVI6GFYjs = require('./__chunk/chunk-PLVI6GFY.js');var _chunkWEW4JBLNjs = require('./__chunk/chunk-WEW4JBLN.js');var _chunkZEKGM362js = require('./__chunk/chunk-ZEKGM362.js');var _chunkPD5FQK7Kjs = require('./__chunk/chunk-PD5FQK7K.js');var _crypto = require('k6/crypto');var A={vus:1,insecureSkipTLSVerify:!0,setupTimeout:"1h"};async function V(){let e=_chunkPD5FQK7Kjs.t.call(void 0, ),o=_chunkPD5FQK7Kjs.v.call(void 0, {userLogin:e.admin.login,userPassword:e.admin.password}),r=await _chunkWEW4JBLNjs.b.call(void 0, {client:o,resourceName:e.seed.container.name,resourceType:e.seed.container.type,userLogin:e.admin.login,platform:e.platform.type}),m=[],y=[];if(e.seed.groups.create){let a=_chunkZEKGM362js.c.call(void 0, {pool:_chunkZEKGM362js.a,n:e.seed.groups.total});await Promise.all(a.map(async({groupName:s})=>{let t=o.group.createGroup({groupName:s}),[c]=_chunkPD5FQK7Kjs.l.call(void 0, "id",t.body),n=c||s;m.push(s),_chunkPD5FQK7Kjs.o.call(void 0, n)}))}if(e.seed.users.create){let a=_chunkZEKGM362js.c.call(void 0, {pool:_chunkZEKGM362js.b,n:e.seed.users.total}),s=o.role.getRoles(),[t]=_chunkPD5FQK7Kjs.l.call(void 0, "$.bundles[?(@.name === 'spaceadmin')].id",_optionalChain([s, 'optionalAccess', _ => _.body])),c=o.application.listApplications(),[n]=_chunkPD5FQK7Kjs.l.call(void 0, "$.value[?(@.displayName === 'ownCloud Infinite Scale')].id",_optionalChain([c, 'optionalAccess', _2 => _2.body]));await Promise.all(a.map(async h=>{let j=o.user.createUser(h),[f]=_chunkPD5FQK7Kjs.l.call(void 0, "$.id",j.body);y.push(f),await o.user.enableUser(h),await o.role.addRoleToUser({appRoleId:t,resourceId:n,principalId:f})}))}if(e.seed.groups.create&&e.seed.users.create){let a=m.filter(Boolean)[0],s=y.filter(Boolean),t={shareResourcePath:r.path,shareReceiver:a};switch(e.seed.container.type){case _chunkPD5FQK7Kjs.b.space:t.shareType=_chunkPD5FQK7Kjs.q.spaceMembershipGroup,t.shareReceiverPermission=_chunkPD5FQK7Kjs.s.coOwner,t.spaceRef=r.root;break;case _chunkPD5FQK7Kjs.b.directory:t.shareType=_chunkPD5FQK7Kjs.q.group,t.shareReceiverPermission=_chunkPD5FQK7Kjs.s.all;break;default:}await o.share.createShare(t),await Promise.all(s.map(async c=>{await o.group.addGroupMember({groupId:a,userId:c})}))}await o.resource.createResource({root:[r.root,r.path].join("/"),resourcePath:e.seed.resource.root}),await Promise.all([e.seed.resource.small,e.seed.resource.medium,e.seed.resource.large].map(async a=>{await o.resource.uploadResource({root:[r.root,r.path,e.seed.resource.root].join("/"),resourcePath:a.name,resourceBytes:_crypto.randomBytes.call(void 0, a.size)})}));{let a=_chunkPLVI6GFYjs.a.call(void 0, {root:e.seed.calendar.root,fromYear:e.seed.calendar.from_year,toYear:e.seed.calendar.to_year});await o.resource.createResource({root:[r.root,r.path].join("/"),resourcePath:a.root}),await Promise.all(a.y.map(async s=>{await o.resource.createResource({root:[r.root,r.path].join("/"),resourcePath:s})})),await Promise.all(a.m.map(async s=>{await o.resource.createResource({root:[r.root,r.path].join("/"),resourcePath:s})})),await Promise.all(a.d.map(async s=>{await o.resource.createResource({root:[r.root,r.path].join("/"),resourcePath:s})})),await Promise.all(a.d.map(async s=>{let t=_chunkPLVI6GFYjs.b.call(void 0, {v:s});await o.resource.uploadResource({root:[r.root,r.path].join("/"),resourcePath:t.resourcePath,resourceBytes:t.resourceContent})}))}}function U(){}exports.default = U; exports.options = A; exports.setup = V;
