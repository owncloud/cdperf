"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_chunks/index-356cf49b.js"),r=require("k6/crypto"),t=require("k6/execution");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("k6"),require("k6/http"),require("k6/encoding"),require("https://jslib.k6.io/url/1.0.0/index.js");var s=n(t),i={baseURL:__ENV.BASE_URL||"https://localhost:9200",authAdapter:__ENV.AUTH_ADAPTER==e.Adapter.basicAuth?e.Adapter.basicAuth:e.Adapter.openIDConnect,apiVersion:__ENV.API_VERSION==e.Version.legacy?e.Version.legacy:e.Version.latest,adminUser:{login:__ENV.ADMIN_LOGIN||"admin",password:__ENV.ADMIN_PASSWORD||"admin"},assets:{size:parseInt(__ENV.ASSET_SIZE)||1024,quantity:parseInt(__ENV.ASSET_QUANTITY)||10},k6:{vus:5,iterations:50,insecureSkipTLSVerify:!0}},a=new e.API(i.baseURL,i.apiVersion),o=i.k6;exports.default=function(t){var n=t.userInfos[s.default.vu.idInTest-1],o=a.user.get(n,i.authAdapter).user,u=r.randomBytes(1024*i.assets.size);e.times_1(i.assets.quantity,(function(e){a.dav.upload(n.home,[s.default.scenario.iterationInTest,n.login,e].join("-"),u,o.credential)}))},exports.options=o,exports.setup=function(){var r=a.user.get({login:i.adminUser.login,password:i.adminUser.password},i.authAdapter).user,t=e.times_1(o.vus||1,(function(){var t=a.user.create({login:e.randomString(),password:e.randomString()},r.credential,i.authAdapter).user;return e._objectSpread2(e._objectSpread2({},t),{},{home:String(a.me.driveInfo(t.login,t.credential,{selector:'value.#(driveType=="personal").id'}))})}));return{adminInfo:r,userInfos:t}},exports.teardown=function(e){var r=e.adminInfo,t=e.userInfos,n=a.user.get(r,i.authAdapter).user;t.forEach((function(e){return a.user.delete(e.login,n.credential)}))};
